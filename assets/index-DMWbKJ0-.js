(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const m=["invertebrate","seed","fish","fruit","rodent","nectar"],C={dieType:"base",faces:["invertebrate","seed","fish","fruit","rodent",["invertebrate","seed"]]},O={dieType:"oceania",faces:["invertebrate",["nectar","seed"],"fish",["nectar","fruit"],"rodent",["invertebrate","seed"]]},h=[C,O],$={numberOfRolls:1,withholdSuccess:!1,rerollWhenAllEqual:!0,countAllFoodOnFaces:!1,countMultipleSuccesses:!1},c={die:C,dieCount:3,selectedFoods:new Set,availableFoods:new Set,advancedOptions:$};function x(){const t=document.getElementById("dice-control"),s=document.createElement("div");s.className="dice-row";const n=document.createElement("button");n.textContent="<";const e=document.createElement("div");e.id="dice-images";const o=document.createElement("button");o.textContent=">",s.appendChild(n),s.appendChild(e),s.appendChild(o);const i=document.createElement("div");i.id="die-count";function a(){i.textContent=`${c.dieCount} ${c.die.dieType} ${c.dieCount===1?"die":"dice"}`,w(c.dieCount,e),f()}return n.addEventListener("click",()=>{c.dieCount>1&&(c.dieCount--,a())}),o.addEventListener("click",()=>{c.dieCount<5&&(c.dieCount++,a())}),t.appendChild(s),t.appendChild(i),a(),t}function w(t,s){s.innerHTML="",s.className="dice-line";for(let n=0;n<t;n++){const e=document.createElement("img");e.src="/wingstats/assets/images/die.png",e.alt=`Die ${n+1}`,e.className="die",s.appendChild(e)}}function S(){const t=document.getElementById("target-food-control");if(!t)throw new Error("target-food-control container not found in DOM");return t.innerHTML="",t.className="food-line",m.forEach(n=>{const e=document.createElement("div");e.className="food-item-wrapper",e.dataset.food=n;const o=document.createElement("img");o.src=`/wingstats/assets/images/${n}.png`,o.alt=n,o.className="food";const i=document.createElement("span");i.textContent=n,i.className="food-name-text",i.style.display="none",o.addEventListener("click",()=>{c.availableFoods.has(n)&&(c.selectedFoods.has(n)?c.selectedFoods.delete(n):c.selectedFoods.add(n),v(t))}),e.appendChild(o),e.appendChild(i),t.appendChild(e)}),E(t),t}function v(t){t.querySelectorAll(".food-item-wrapper").forEach(n=>{const e=n.querySelector(".food"),o=n.querySelector(".food-name-text");if(!e||!o)return;const i=e.alt;c.availableFoods.has(i)?(e.classList.remove("disabled"),e.style.opacity="",e.style.pointerEvents="",e.classList.remove("selected","unselected")):(e.classList.add("disabled"),e.style.opacity="0.4",e.style.pointerEvents="none",e.classList.remove("selected","unselected")),c.selectedFoods.size===0?(e.classList.remove("selected","unselected"),e.src=`/wingstats/assets/images/${i}.png`,o.style.display="none"):c.selectedFoods.has(i)?(e.classList.add("selected"),e.classList.remove("unselected"),e.src=`/wingstats/assets/images/${i}-glow.png`,o.style.display="block"):(e.classList.add("unselected"),e.classList.remove("selected"),e.src=`/wingstats/assets/images/${i}.png`,o.style.display="none")}),f()}function E(t){c.selectedFoods=new Set,v(t)}function b(t){return`${t[0].toUpperCase()}${t.slice(1)}`}function g(t){const s=t.replace(/([A-Z])/g," $1");return s.charAt(0).toUpperCase()+s.slice(1)}function y(t){if(t===0)return"0%";const s=t*100;let n="";const e=1/t;let o;if(e>10?o=Math.round(e).toLocaleString():(o=e.toFixed(1),o.endsWith(".0")&&(o=o.substring(0,o.length-2))),e>=1?n=` (approx. 1 in ${o})`:e<1&&e>0&&(n=" (approx. 1 in 1)"),s>=.1)return`${s.toFixed(2)}%${n}`;let i=3,a=s.toFixed(i);for(;parseFloat(a)===0&&i<20;)i++,a=s.toFixed(i);return`${a}%${n}`}function T(t,s){if(s<0||s>t)return 0;if(s===0||s===t)return 1;s>t/2&&(s=t-s);let n=1;for(let e=1;e<=s;e++)n=n*(t-e+1)/e;return n}function L(){const t=document.getElementById("advanced-options-control");t.innerHTML="";const s=document.createElement("div");s.className="advanced-options-section";const n=document.createElement("div");n.className="advanced-options-header",n.textContent="▸ Advanced Options (Click to Expand)",n.setAttribute("aria-expanded","false");const e=document.createElement("div");e.className="advanced-options-content hidden";const o=c.advancedOptions;for(const i in o){const a=o[i];if(i==="numberOfRolls"){const r=o[i],d=document.createElement("label");d.className="advanced-option-label";const u=document.createTextNode(g(i)+":"),l=document.createElement("input");l.type="number",l.min="1",l.max="5",l.value=String(r),l.id=`opt-${i}`,l.onchange=()=>{let p=parseInt(l.value,10);isNaN(p)||p<1?p=1:p>5&&(p=5),l.value=String(p),c.advancedOptions[i]=p,f()},d.appendChild(u),d.appendChild(l),e.appendChild(d);continue}if(typeof a=="boolean"){const r=document.createElement("label");r.className="advanced-option-label";const d=document.createElement("input");d.type="checkbox",d.checked=a,d.id=`opt-${i}`,d.setAttribute("aria-label",g(i)),d.onchange=()=>{c.advancedOptions[i]=d.checked,f()},r.appendChild(d),r.appendChild(document.createTextNode(g(i))),e.appendChild(r)}}return n.onclick=()=>{const i=e.classList.toggle("hidden");n.setAttribute("aria-expanded",String(!i));const a=i?"▸":"▾",r=i?"Expand":"Collapse";n.textContent=`${a} Advanced Options (Click to ${r})`},s.appendChild(n),s.appendChild(e),t.appendChild(s),t}const N=()=>{const t=[];let s;switch(c.advancedOptions.numberOfRolls){case 1:s="just once";break;case 2:s="twice";break;case 3:s="thrice";break;default:s=`${c.advancedOptions.numberOfRolls} times`;break}c.dieCount>0&&t.push(`Rolling ${c.dieCount} ${b(c.die.dieType)} Di${c.dieCount>1?"c":""}e ${s}`);const n=m.filter(e=>c.selectedFoods.has(e)).map(b);if(n.length>0){let e;const o=n.length;if(o===1)e=n[0];else if(o===2)e=n.join(" and ");else{const i=n[o-1];e=`${n.slice(0,o-1).join(", ")}, and ${i}`}t.push(`Targeting: ${e}`)}else t.push("No Food Target(s) Selected");return c.dieCount===5&&!c.advancedOptions.rerollWhenAllEqual&&t.push("No 'reroll' permitted when all 5 faces are equal"),c.advancedOptions.withholdSuccess&&t.push("Withhold Successes: Enabled"),c.advancedOptions.countAllFoodOnFaces&&t.push("Count All Food on Faces: Enabled"),c.advancedOptions.countMultipleSuccesses&&t.push("Counting Multiple Successes: Enabled"),t.join(`
`)};function f(){const t=document.getElementById("results");if(!t)throw new Error("results container not found in DOM");t.innerHTML="";const s=document.createElement("pre");s.textContent=N();const n=D();t.appendChild(s),t.appendChild(n)}function F(t,s=!1){const n={},e=1-t;for(let o=0;o<=c.dieCount;o++){const i=T(c.dieCount,o);n[o]=i*Math.pow(t,o)*Math.pow(e,c.dieCount-o)}if(c.advancedOptions.rerollWhenAllEqual&&c.dieCount===5&&!s){const i=c.die.faces.filter(d=>(Array.isArray(d)?d:[d]).every(l=>!c.selectedFoods.has(l))).length*Math.pow(1/c.die.faces.length,c.dieCount),a=F(t,!0),r=i;for(let d=0;d<=c.dieCount;d++){let u;d===0?u=n[0]-r:u=n[d];const l=a[d]*r;n[d]=u+l}}return n}function A(){if(c.dieCount===0||c.selectedFoods.size===0)return{0:1};const s=c.die.faces.filter(e=>(Array.isArray(e)?e:[e]).some(i=>c.selectedFoods.has(i))).length/c.die.faces.length;return F(s)}function D(){const t=document.createElement("div");t.className="probability-div";const s=40,n=A(),e=[],o=Object.keys(n).map(Number).sort((a,r)=>a-r),i=o.filter(a=>a>=1).reduce((a,r)=>a+n[r],0);if(i>0&&(e.push(`(P ≥ 1 success): ${y(i)}`),e.push("---")),c.advancedOptions.countMultipleSuccesses)for(const a of o){const r=n[a],d=y(r),p=`P(exactly ${a} ${a===1?"success":"successes"}):`.padEnd(s," ");e.push(`${p}${d}`)}return console.log(e),t.innerHTML=e.join(`
`),t.style.whiteSpace="pre-wrap",t}function I(){const t=document.getElementById("dice-type-control"),s=document.createElement("div");s.className="dice-type-row";const n=document.createElement("button");n.textContent="<";const e=document.createElement("div");e.className="dice-type-line",e.id="die-type";const o=document.createElement("button");o.textContent=">",s.appendChild(n),s.appendChild(e),s.appendChild(o);function i(){e.textContent=`${b(c.die.dieType)} Dice`,M(c.die),f()}function a(){const d=(h.findIndex(u=>u.dieType===c.die.dieType)+1)%h.length;c.die=h[d],i()}return n.addEventListener("click",a),o.addEventListener("click",a),t.appendChild(s),i(),t}function M(t){c.die=t,t.dieType==="base"?c.availableFoods=new Set(m.filter(n=>n!=="nectar")):c.availableFoods=new Set(m);const s=document.getElementById("target-food-control");s&&E(s)}console.log("App version: 0.1.0");const k=document.getElementById("layout-root");k&&(I(),x(),S(),L());
